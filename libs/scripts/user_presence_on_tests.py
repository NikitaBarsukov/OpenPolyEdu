import sys
import datetime
import ntpath

import plotly.express as px
import pandas as pd
import csv

from tabulate import tabulate
import plotly.graph_objects as go
from database_services import *


def getListOfUserSessions(connection, userId):
    query = """
        SELECT 
           TO_DATE(log_line ->> 'time', 'YYYY-MM-DD"T"HH24:MI:SS')::DATE                     AS session_date,
           log_line -> 'session'                                                             AS session_name,
           age(MAX(TO_TIMESTAMP(log_line ->> 'time', 'YYYY-MM-DD"T"HH24:MI:SS')::TIMESTAMP),
               MIN(TO_TIMESTAMP(log_line ->> 'time', 'YYYY-MM-DD"T"HH24:MI:SS')::TIMESTAMP)) AS session_duration
            FROM logs
            WHERE log_line ->> 'session' != 'null'
              AND log_line ->> 'session' != ''
              AND log_line #>> '{0}' = '{1}'
            GROUP BY session_name, session_date;
        """.format("{context, user_id}", userId)
    return execute_query(connection, query, "Sessions has been taken")


def getTimePresenceForSession(connection, session):
    query = """
            WITH
            link_events_table AS (
            SELECT (log_line ->> 'event')::json ->> 'target_url' as event,
                   log_line ->> 'time'  as time,
                   log_line ->> 'session' as session
            FROM logs
            WHERE log_line ->> 'name' LIKE '%link%' AND
                  log_line ->> 'session' = '{0}'
            
            ),
            test_url AS (
            SELECT log_line ->> 'time' as time,
                   log_line ->> 'page' as page,
                   log_line ->> 'session' as session
             FROM logs
             WHERE log_line ->> 'session' = '{0}'
               AND log_line ->> 'name' = 'problem_graded'
            )
            SELECT age(TO_TIMESTAMP(test_url.time, 'YYYY-MM-DD"T"HH24:MI:SS')::TIMESTAMP,
                       TO_TIMESTAMP(link_events_table.time, 'YYYY-MM-DD"T"HH24:MI:SS')::TIMESTAMP) as presence,
                   test_url.page
            FROM test_url
            JOIN  link_events_table ON link_events_table.event = test_url.page AND link_events_table.session = test_url.session 
            """.format(session)
    return execute_query(connection, query)


def write_result_to_file(result_file, result):
    print('Start writing the data to file.')
    with open(result_file, mode='w', encoding='utf-8') as res_file:
        field_names = ['pdf', 'views amount']
        result_file_writer = csv.writer(res_file, delimiter=',', quotechar='"', quoting=csv.QUOTE_MINIMAL)
        result_file_writer.writerow(field_names)
        for res in result:
            result_file_writer.writerow(res)

def writeToFile(resultFile, results):
    def getNeededDataFromResultRow(resultRow):
        delta = resultRow[2][0][0]
        if resultRow[2][0][0].days < 0: return ''
        # return resultRow[0], resultRow[2][0][0]
        return resultRow[0], resultRow[2][0][0], resultRow[1], resultRow[2][0][1].split("/")[-2] + "/" + resultRow[2][0][1].split("/")[-3]
    def getNeededDataFromResultRowForGraph(resultRow):
        return resultRow[0], resultRow[2][0][0]
    print('Start writing the data to file.')
    toOut = [getNeededDataFromResultRow(x) for x in results]
    graphFileName = resultFile + "-graph.csv"
    with open(resultFile,"w") as file:
        file.write(tabulate(toOut, headers=['Date', 'Time presence', 'Time Session ID', 'Test Id']))
    print('The analytics result can be found at ', resultFile)
    toOut = [getNeededDataFromResultRowForGraph(x) for x in results]
    print(toOut)
    with open(graphFileName, mode='w', encoding='utf-8') as file:
        field_names = ['Date', 'Time presence']
        result_file_writer = csv.writer(file, delimiter=',', quotechar='"', quoting=csv.QUOTE_MINIMAL)
        result_file_writer.writerow(field_names)
        for res in toOut:
            result_file_writer.writerow(res)

    print('Figure file genrated ', graphFileName)


def generate_figure():
    df = pd.read_csv("res.csv-graph.csv")
    print(df)
    fig = px.bar(df, x='Date', y='Time presence')
    fig.show()

def sumTime(queryResultList: list, timeColumnPos):
    timeVar = datetime.timedelta(seconds=0)
    for row in queryResultList:
        timeVar += row[timeColumnPos]
    return timeVar


def calculateTimePresence(connection, userId):
    # userSessions = [(datetime.date(2018, 11, 17), 'ecfb5970aeaf13d6489a4df1c08a79f3', datetime.timedelta(seconds=712))]
    userSessions = getListOfUserSessions(connection, userId)
    amountTimeOnSessions = None
    amountTimeOnTests = None
    result = []
    i = 0
    print("Starting calculate test presence on {0}".format(datetime.datetime.now()))
    for row in userSessions:
        i+=1
        print("{1}\{2}. Session {0}".format(row[1], i, len(userSessions)))
        presenceOnTests = getTimePresenceForSession(connection, row[1])
        if len(presenceOnTests) == 0:
            print("Test presence within session â€“ {0} not found ".format(row[1]))
            continue
        amountTimeOnTests = sumTime(presenceOnTests, 0)
        resultRow = row[0], row[1], presenceOnTests, amountTimeOnTests
        result.append(resultRow)
    print("Test presence has been calculated on {0}".format(datetime.datetime.now()))
    print(result)


def main(argv):
    database_name = argv[1]
    user_name = argv[2]
    result_file = argv[3]

    # connection = open_db_connection(database_name, user_name)
    # # userSessions = [(datetime.date(2018, 11, 5), '042261645c2ece9a9e582490d1534458', datetime.timedelta(seconds=725)), (datetime.date(2018, 10, 14), '0b19fe640d5819b4091013d18424564a', datetime.timedelta(seconds=5054)), (datetime.date(2018, 10, 21), '0f52e055cc6dc593bb4d5b3530def054', datetime.timedelta(seconds=429)), (datetime.date(2018, 11, 5), '105e35d78e80b0236c279a551c742332', datetime.timedelta(seconds=357)), (datetime.date(2018, 12, 2), '1304275c69ccb17d56ef288bc550e536', datetime.timedelta(seconds=111)), (datetime.date(2018, 11, 5), '1ad70239741ada024003082a6f0658b6', datetime.timedelta(0)), (datetime.date(2018, 9, 30), '22739625e0e233712511e028761104fc', datetime.timedelta(seconds=1361)), (datetime.date(2018, 10, 1), '22739625e0e233712511e028761104fc', datetime.timedelta(seconds=613)), (datetime.date(2018, 11, 26), '29260eed54b0eaf2eeacd485634a4196', datetime.timedelta(seconds=210)), (datetime.date(2018, 10, 22), '2b64b6b57b2763b173b309362622caa6', datetime.timedelta(seconds=146)), (datetime.date(2018, 12, 3), '2b68357d5575138cdc65515020e1b846', datetime.timedelta(seconds=110)), (datetime.date(2018, 12, 2), '30f13f54d21d1748e85eeedd3fa26cf8', datetime.timedelta(seconds=582)), (datetime.date(2018, 10, 21), '3635b9d1b93181cc83ba7f2d82f297c0', datetime.timedelta(seconds=253)), (datetime.date(2018, 12, 24), '39867a21b8f3aafda16bfd4e1ab6f8e9', datetime.timedelta(seconds=4095)), (datetime.date(2018, 12, 16), '3f30c2a8dc95d278ba386cf42a949962', datetime.timedelta(seconds=1888)), (datetime.date(2018, 10, 22), '3fbcac90f02a24dde3ab1d5dfe1c4e36', datetime.timedelta(seconds=4)), (datetime.date(2018, 10, 30), '4075b8fc95907e2c2d845d946b2dd964', datetime.timedelta(0)), (datetime.date(2018, 12, 16), '448fe7cc2b351702561e999f87fb89c1', datetime.timedelta(seconds=280)), (datetime.date(2018, 11, 17), '461a77fee3890e87decff12ec81d6fee', datetime.timedelta(seconds=325)), (datetime.date(2018, 11, 26), '47318a42b5ab85bf03800e861460107b', datetime.timedelta(seconds=158)), (datetime.date(2018, 12, 2), '56cbaf1913e6b20b02c58c9dd330d960', datetime.timedelta(seconds=119)), (datetime.date(2018, 10, 14), '57c8a70acf48294b9c4db1bfa938fe6b', datetime.timedelta(seconds=838)), (datetime.date(2018, 12, 10), '5ac70a21fba6303c8bf5aa592c041f10', datetime.timedelta(seconds=312)), (datetime.date(2018, 12, 14), '63a16302333cf5ee64ff3b1eaec5f8b0', datetime.timedelta(seconds=2041)), (datetime.date(2018, 11, 11), '674580a3921d8ca4bc93722e3a77859b', datetime.timedelta(seconds=240)), (datetime.date(2018, 10, 29), '680b9fb72c415f1f05548c25f5ab4116', datetime.timedelta(seconds=157)), (datetime.date(2018, 11, 25), '6df6c5169684178c6334d81dfac61195', datetime.timedelta(seconds=194)), (datetime.date(2018, 9, 30), '6e5684cd3600e7322ac360c832e57426', datetime.timedelta(seconds=80)), (datetime.date(2018, 12, 18), '714bf6f906fd743fee1cbfbe6498955e', datetime.timedelta(seconds=174)), (datetime.date(2018, 9, 26), '7511922f46a72c21ff027738ca94c60f', datetime.timedelta(seconds=1812)), (datetime.date(2018, 12, 2), '7b2c0c1ecf08c3b7e6e663c555996a29', datetime.timedelta(seconds=100)), (datetime.date(2018, 10, 13), '85965ab411cb424bb9af39e4e0af7ec5', datetime.timedelta(seconds=442)), (datetime.date(2018, 11, 19), '85fb326c60b6675690cc7044f2d2572d', datetime.timedelta(seconds=408)), (datetime.date(2018, 9, 30), '861baa06bc3b8753b5a6064596c0f7be', datetime.timedelta(seconds=1661)), (datetime.date(2018, 12, 18), '875fb7061cfe7b71eb74cc7a05767946', datetime.timedelta(seconds=1641)), (datetime.date(2018, 12, 16), '8d3a396eb0a3c32b128a5d25d68293d0', datetime.timedelta(seconds=448)), (datetime.date(2018, 12, 16), '8ea4723e616a6a9f04aa52831bf0165b', datetime.timedelta(seconds=26)), (datetime.date(2018, 11, 5), '8ec30bfd9b38ae3a3b04fc58fcaa4d5b', datetime.timedelta(seconds=97)), (datetime.date(2018, 11, 5), '909963a3c0df12274e644e941cb02ce6', datetime.timedelta(seconds=148)), (datetime.date(2018, 10, 7), '9277c59b8cbc12f802de56b6b2310f51', datetime.timedelta(seconds=676)), (datetime.date(2018, 11, 25), '932058b32b55a0c07cb12027553499c7', datetime.timedelta(seconds=299)), (datetime.date(2018, 12, 17), '940ee589bf2e43509c31514a51dcb1ed', datetime.timedelta(seconds=769)), (datetime.date(2018, 10, 29), 'a2db55ef4fbd641016a62cc768a0157c', datetime.timedelta(seconds=187)), (datetime.date(2018, 12, 4), 'a5deca130853c913a0d75ed630b47ecf', datetime.timedelta(seconds=77)), (datetime.date(2018, 9, 30), 'af82b202efa2e3b7d9301dff96a75284', datetime.timedelta(seconds=7)), (datetime.date(2018, 11, 3), 'b23a0ee02a4868457730d7d8dea8dcb0', datetime.timedelta(seconds=41)), (datetime.date(2018, 10, 1), 'b8702bdc044ae16ad763f73e15277ae6', datetime.timedelta(seconds=4469)), (datetime.date(2018, 11, 5), 'bbba3b497763344ac6c66d9a8ef0bfda', datetime.timedelta(seconds=120)), (datetime.date(2018, 12, 9), 'bd31e294ce971d2c99bd10f3c4b35ec2', datetime.timedelta(seconds=428)), (datetime.date(2018, 10, 7), 'cf57d64790624c699e72e47bd8036fe6', datetime.timedelta(seconds=818)), (datetime.date(2018, 10, 8), 'cf5a56fed0345f83ea79feb2a3aab3e8', datetime.timedelta(seconds=420)), (datetime.date(2018, 10, 15), 'd4a6118eb6b682de0f8b0c9d7e9958af', datetime.timedelta(seconds=82)), (datetime.date(2018, 11, 12), 'd918b4d6c22ff9681eadefc367fd3321', datetime.timedelta(seconds=191)), (datetime.date(2018, 12, 17), 'dddad36aff217af308d1867bf4dfe2bb', datetime.timedelta(seconds=175)), (datetime.date(2018, 11, 18), 'de06779826bed0d97a450b46541b68ab', datetime.timedelta(seconds=2130)), (datetime.date(2018, 11, 6), 'de92d67b4a953a4bb965c2a7e7a434cf', datetime.timedelta(seconds=10533)), (datetime.date(2018, 12, 3), 'e0a539ea18b26c93cd2eeffc53b3e00b', datetime.timedelta(seconds=199)), (datetime.date(2018, 11, 12), 'e180533ac27d31ff16408948ffe387d4', datetime.timedelta(seconds=245)), (datetime.date(2018, 10, 29), 'ec570a844680b855e31f7dec1370dd93', datetime.timedelta(seconds=211)), (datetime.date(2018, 11, 17), 'ecfb5970aeaf13d6489a4df1c08a79f3', datetime.timedelta(seconds=712)), (datetime.date(2018, 12, 2), 'f441a56f23390c89c552e91c643d6d87', datetime.timedelta(seconds=2261)), (datetime.date(2018, 11, 13), 'f5294186d18e15ccaa60a5292560267d', datetime.timedelta(seconds=109)), (datetime.date(2019, 1, 10), 'f7d078c53165ae63ce965d3890d36b6d', datetime.timedelta(seconds=2)), (datetime.date(2018, 10, 23), 'fb390b3e4e3975fb3c93f73ce0a433de', datetime.timedelta(seconds=3)), (datetime.date(2018, 10, 21), 'fdf814eabdb20433ed3f1db0a134f523', datetime.timedelta(seconds=18))]
    #
    # calculateTimePresence(connection, "340786")
    results = [(datetime.date(2018, 11, 5), '105e35d78e80b0236c279a551c742332', [(datetime.timedelta(seconds=45), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/f84f15470d0e4bf0b049a0c9b487d48c/42149561f4564b4cbeb63c885202a5a7/')], datetime.timedelta(seconds=45)), (datetime.date(2018, 12, 2), '1304275c69ccb17d56ef288bc550e536', [(datetime.timedelta(seconds=103), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/f93d7343f26644b790a026a0ab9161c4/87a33def05f7419ebb1d61ceec9d06c3/')], datetime.timedelta(seconds=103)), (datetime.date(2018, 9, 30), '22739625e0e233712511e028761104fc', [(datetime.timedelta(seconds=43), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e5303109ad5a4988b17dc0db8e292325/db110fe478f0461e85e7ecba2f02293f/'), (datetime.timedelta(days=-1, seconds=24183), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e5303109ad5a4988b17dc0db8e292325/db110fe478f0461e85e7ecba2f02293f/')], datetime.timedelta(days=-1, seconds=24226)), (datetime.date(2018, 10, 1), '22739625e0e233712511e028761104fc', [(datetime.timedelta(seconds=43), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e5303109ad5a4988b17dc0db8e292325/db110fe478f0461e85e7ecba2f02293f/'), (datetime.timedelta(days=-1, seconds=24183), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e5303109ad5a4988b17dc0db8e292325/db110fe478f0461e85e7ecba2f02293f/')], datetime.timedelta(days=-1, seconds=24226)), (datetime.date(2018, 12, 2), '30f13f54d21d1748e85eeedd3fa26cf8', [(datetime.timedelta(seconds=81), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/4e55c94c778240c4a378c13d7bae252e/47612f08e6f44edca5063576a65dedf0/'), (datetime.timedelta(seconds=69), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/4e55c94c778240c4a378c13d7bae252e/47612f08e6f44edca5063576a65dedf0/'), (datetime.timedelta(seconds=60), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/4e55c94c778240c4a378c13d7bae252e/c0ff36af3186413c9d3d368167c9d9bc/')], datetime.timedelta(seconds=210)), (datetime.date(2018, 10, 21), '3635b9d1b93181cc83ba7f2d82f297c0', [(datetime.timedelta(seconds=92), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/d49f80aa711548e58cf84c8f49340071/6475eabaddda4594966fc208d5c45895/'), (datetime.timedelta(seconds=68), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/d49f80aa711548e58cf84c8f49340071/6475eabaddda4594966fc208d5c45895/'), (datetime.timedelta(seconds=85), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/d49f80aa711548e58cf84c8f49340071/6475eabaddda4594966fc208d5c45895/'), (datetime.timedelta(seconds=81), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/d49f80aa711548e58cf84c8f49340071/6475eabaddda4594966fc208d5c45895/'), (datetime.timedelta(seconds=72), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/d49f80aa711548e58cf84c8f49340071/6475eabaddda4594966fc208d5c45895/'), (datetime.timedelta(seconds=88), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/d49f80aa711548e58cf84c8f49340071/6475eabaddda4594966fc208d5c45895/'), (datetime.timedelta(seconds=65), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/d49f80aa711548e58cf84c8f49340071/6475eabaddda4594966fc208d5c45895/'), (datetime.timedelta(seconds=70), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/d49f80aa711548e58cf84c8f49340071/6475eabaddda4594966fc208d5c45895/'), (datetime.timedelta(seconds=66), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/d49f80aa711548e58cf84c8f49340071/6475eabaddda4594966fc208d5c45895/'), (datetime.timedelta(seconds=59), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/d49f80aa711548e58cf84c8f49340071/6475eabaddda4594966fc208d5c45895/'), (datetime.timedelta(seconds=41), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/d49f80aa711548e58cf84c8f49340071/03f05523982d412b918cc94c3b3c3be9/')], datetime.timedelta(seconds=787)), (datetime.date(2018, 12, 24), '39867a21b8f3aafda16bfd4e1ab6f8e9', [(datetime.timedelta(seconds=55), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/c74568c00f9f4d65a99d23d310030902/120246d5b13f4d6bb631dc33aa5c61a8/'), (datetime.timedelta(seconds=38), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/c74568c00f9f4d65a99d23d310030902/14083491c2804ae9a42b839d9cf749d4/'), (datetime.timedelta(seconds=54), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e773c67d4ced405ea7faadc27eb0665e/2e5be0a197aa463a9f478ec4043a91d4/'), (datetime.timedelta(days=-1, seconds=86324), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=86195), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=86164), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=86185), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=86090), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=86035), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=86126), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=86072), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=86059), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=86153), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=86016), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85987), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=86002), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85967), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85942), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85887), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85850), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85776), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85871), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85670), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85661), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85695), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85637), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85645), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85613), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85652), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85538), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85369), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85327), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85387), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85284), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85309), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85245), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85225), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85204), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85261), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85184), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85167), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=85080), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=84883), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=84964), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=84931), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=84898), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=84982), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=84565), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=84523), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=84444), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=84442), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=84643), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(days=-1, seconds=84440), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=58), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e773c67d4ced405ea7faadc27eb0665e/2cf5f79bbc44474496dff923b9b8e0fc/'), (datetime.timedelta(seconds=118), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e773c67d4ced405ea7faadc27eb0665e/2e5be0a197aa463a9f478ec4043a91d4/'), (datetime.timedelta(seconds=35), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e773c67d4ced405ea7faadc27eb0665e/2e5be0a197aa463a9f478ec4043a91d4/'), (datetime.timedelta(seconds=2737), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2608), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2577), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2598), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2503), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2448), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2539), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2485), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2472), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2566), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2429), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2400), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2415), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2380), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2355), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2300), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2263), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2189), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2284), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2083), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2074), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2108), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2050), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2058), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2026), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=2065), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1951), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1782), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1740), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1800), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1697), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1722), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1658), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1638), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1617), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1674), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1597), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1580), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1493), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1296), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1377), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1344), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1311), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1395), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=978), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=936), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=857), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=855), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=1056), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/'), (datetime.timedelta(seconds=853), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/0bd71bc4466b4fdba2e282efa76d6602/546cacb662514e9a88f37cc1de1dd1b1/')], datetime.timedelta(seconds=50146)), (datetime.date(2018, 12, 2), '56cbaf1913e6b20b02c58c9dd330d960', [(datetime.timedelta(days=-1, seconds=86356), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/f93d7343f26644b790a026a0ab9161c4/81fb6dbfcff840dd90f8f56dc1e461db/')], datetime.timedelta(days=-1, seconds=86356)), (datetime.date(2018, 11, 11), '674580a3921d8ca4bc93722e3a77859b', [(datetime.timedelta(seconds=53), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e4380cc6275d4cda94980a3a63859369/0864c4307d4a4ca2892e2208f716c077/'), (datetime.timedelta(seconds=158), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e4380cc6275d4cda94980a3a63859369/0864c4307d4a4ca2892e2208f716c077/')], datetime.timedelta(seconds=211)), (datetime.date(2018, 10, 13), '85965ab411cb424bb9af39e4e0af7ec5', [(datetime.timedelta(seconds=27), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/df482a76976049cf9c3058a7bdfc7084/f3dd04217e344c53b9b925e9b86c3933/'), (datetime.timedelta(seconds=35), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/df482a76976049cf9c3058a7bdfc7084/f3dd04217e344c53b9b925e9b86c3933/'), (datetime.timedelta(seconds=43), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/df482a76976049cf9c3058a7bdfc7084/f3dd04217e344c53b9b925e9b86c3933/'), (datetime.timedelta(seconds=267), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/df482a76976049cf9c3058a7bdfc7084/2cd8acbb87784969b5f6c4b25c15546f/'), (datetime.timedelta(seconds=33), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/df482a76976049cf9c3058a7bdfc7084/a4c4cca8d8094e7c9f836eb335b5bbbf/'), (datetime.timedelta(seconds=43), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/df482a76976049cf9c3058a7bdfc7084/a4c4cca8d8094e7c9f836eb335b5bbbf/')], datetime.timedelta(seconds=448)), (datetime.date(2018, 9, 30), '861baa06bc3b8753b5a6064596c0f7be', [(datetime.timedelta(seconds=98), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/a1b314bc847145cdbbce7722cf290a46/2e34698ee1a243c29453e69e85f9d4ea/'), (datetime.timedelta(seconds=90), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/a1b314bc847145cdbbce7722cf290a46/2e34698ee1a243c29453e69e85f9d4ea/'), (datetime.timedelta(seconds=164), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/a1b314bc847145cdbbce7722cf290a46/9252a737379b469fbe6362263eb368df/'), (datetime.timedelta(seconds=130), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/a1b314bc847145cdbbce7722cf290a46/9252a737379b469fbe6362263eb368df/'), (datetime.timedelta(seconds=152), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/a1b314bc847145cdbbce7722cf290a46/9252a737379b469fbe6362263eb368df/'), (datetime.timedelta(seconds=98), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e5303109ad5a4988b17dc0db8e292325/7ca04f9a7d9a4d8da00fce4c0cda8e96/'), (datetime.timedelta(seconds=140), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e5303109ad5a4988b17dc0db8e292325/db110fe478f0461e85e7ecba2f02293f/'), (datetime.timedelta(seconds=57), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e5303109ad5a4988b17dc0db8e292325/7ca04f9a7d9a4d8da00fce4c0cda8e96/'), (datetime.timedelta(seconds=38), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e5303109ad5a4988b17dc0db8e292325/9d291470cac44b62b9087eb256ac1550/'), (datetime.timedelta(seconds=60), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e5303109ad5a4988b17dc0db8e292325/9d291470cac44b62b9087eb256ac1550/'), (datetime.timedelta(days=-1, seconds=86182), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e5303109ad5a4988b17dc0db8e292325/7ca04f9a7d9a4d8da00fce4c0cda8e96/'), (datetime.timedelta(seconds=262), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/a1b314bc847145cdbbce7722cf290a46/2e34698ee1a243c29453e69e85f9d4ea/'), (datetime.timedelta(seconds=254), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/a1b314bc847145cdbbce7722cf290a46/2e34698ee1a243c29453e69e85f9d4ea/'), (datetime.timedelta(days=-1, seconds=85813), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/a1b314bc847145cdbbce7722cf290a46/2e34698ee1a243c29453e69e85f9d4ea/'), (datetime.timedelta(days=-1, seconds=85805), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/a1b314bc847145cdbbce7722cf290a46/2e34698ee1a243c29453e69e85f9d4ea/'), (datetime.timedelta(seconds=69), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e5303109ad5a4988b17dc0db8e292325/db110fe478f0461e85e7ecba2f02293f/'), (datetime.timedelta(days=-1, seconds=86302), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e5303109ad5a4988b17dc0db8e292325/9d291470cac44b62b9087eb256ac1550/'), (datetime.timedelta(days=-1, seconds=86324), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e5303109ad5a4988b17dc0db8e292325/9d291470cac44b62b9087eb256ac1550/')], datetime.timedelta(seconds=38)), (datetime.date(2018, 12, 16), '8d3a396eb0a3c32b128a5d25d68293d0', [(datetime.timedelta(seconds=97), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/f26a89c3f158458dbfaf318ffd645fd5/191b38cf1df94eac97ed49b053feee80/'), (datetime.timedelta(seconds=51), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/f26a89c3f158458dbfaf318ffd645fd5/191b38cf1df94eac97ed49b053feee80/'), (datetime.timedelta(seconds=36), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/f26a89c3f158458dbfaf318ffd645fd5/f71d7f9ad9b3496eb14b4b9d4860e5ac/'), (datetime.timedelta(seconds=36), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/d4506cc6380b4f50a8919cc6300f2017/146dfa703f1a47f7a35af2265de94c98/')], datetime.timedelta(seconds=220)), (datetime.date(2018, 11, 25), '932058b32b55a0c07cb12027553499c7', [(datetime.timedelta(seconds=44), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e7680f87e11641aa96d1d02e875466de/0fae78e26bb8409684bf8059289fe554/'), (datetime.timedelta(seconds=72), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/e7680f87e11641aa96d1d02e875466de/8387b0a0fdcf48d190cf276c71d401c1/')], datetime.timedelta(seconds=116)), (datetime.date(2018, 12, 9), 'bd31e294ce971d2c99bd10f3c4b35ec2', [(datetime.timedelta(seconds=23), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/fec67eb9c2134f3ebafdb3375781137f/01d8fbb0dba74cffa4e947cfe1622536/'), (datetime.timedelta(seconds=87), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/cf94d3e1e7814b9d9e503355ae55e620/9033aae1b9f54e2e9b599c0ff5d93145/'), (datetime.timedelta(seconds=83), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/cf94d3e1e7814b9d9e503355ae55e620/9033aae1b9f54e2e9b599c0ff5d93145/'), (datetime.timedelta(seconds=77), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/cf94d3e1e7814b9d9e503355ae55e620/9033aae1b9f54e2e9b599c0ff5d93145/'), (datetime.timedelta(seconds=71), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/cf94d3e1e7814b9d9e503355ae55e620/9033aae1b9f54e2e9b599c0ff5d93145/'), (datetime.timedelta(seconds=64), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/cf94d3e1e7814b9d9e503355ae55e620/9033aae1b9f54e2e9b599c0ff5d93145/'), (datetime.timedelta(seconds=60), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/cf94d3e1e7814b9d9e503355ae55e620/9033aae1b9f54e2e9b599c0ff5d93145/'), (datetime.timedelta(seconds=51), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/cf94d3e1e7814b9d9e503355ae55e620/9033aae1b9f54e2e9b599c0ff5d93145/'), (datetime.timedelta(seconds=45), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/cf94d3e1e7814b9d9e503355ae55e620/9033aae1b9f54e2e9b599c0ff5d93145/'), (datetime.timedelta(seconds=40), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/cf94d3e1e7814b9d9e503355ae55e620/9033aae1b9f54e2e9b599c0ff5d93145/'), (datetime.timedelta(seconds=38), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/cf94d3e1e7814b9d9e503355ae55e620/9033aae1b9f54e2e9b599c0ff5d93145/'), (datetime.timedelta(seconds=44), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/cf94d3e1e7814b9d9e503355ae55e620/6fd44bc4aa854265a19adc0a2822d05c/'), (datetime.timedelta(seconds=76), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/fec67eb9c2134f3ebafdb3375781137f/a77601425d8046a784db7482b0a8c94c/'), (datetime.timedelta(seconds=45), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/fec67eb9c2134f3ebafdb3375781137f/06f0ee448ad4480ea637ff0c37e202b8/')], datetime.timedelta(seconds=804)), (datetime.date(2018, 10, 7), 'cf57d64790624c699e72e47bd8036fe6', [(datetime.timedelta(seconds=252), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/88cd2761424245c7b55d8995e71ab019/a74f542e9dcf4f9da341ac1fe6a7f4c6/'), (datetime.timedelta(seconds=416), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/88cd2761424245c7b55d8995e71ab019/27af773385864dbfb0dc13d2285594f3/'), (datetime.timedelta(seconds=344), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/88cd2761424245c7b55d8995e71ab019/27af773385864dbfb0dc13d2285594f3/'), (datetime.timedelta(seconds=77), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/88cd2761424245c7b55d8995e71ab019/4c6cf6cf2ef34d7da83d029abe4f3904/'), (datetime.timedelta(seconds=73), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/88cd2761424245c7b55d8995e71ab019/4c6cf6cf2ef34d7da83d029abe4f3904/')], datetime.timedelta(seconds=1162)), (datetime.date(2018, 10, 29), 'ec570a844680b855e31f7dec1370dd93', [(datetime.timedelta(seconds=49), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/d577baef4d604c29a2b52f2e85803b0b/0d1af864fcfc460293e5a5663f81e018/'), (datetime.timedelta(seconds=68), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/d577baef4d604c29a2b52f2e85803b0b/2ecf46b800c94f0c921e2af04c6bcdca/')], datetime.timedelta(seconds=117)), (datetime.date(2018, 11, 17), 'ecfb5970aeaf13d6489a4df1c08a79f3', [(datetime.timedelta(seconds=80), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/1c7d88a820db46d093be188edfe325d6/6396cae92b0442419cbf0491de7626a2/'), (datetime.timedelta(seconds=50), 'https://courses.openedu.ru/courses/course-v1:spbstu+PHYLOS+fall_2018/courseware/1c7d88a820db46d093be188edfe325d6/42bb1830e25e46c4ba9d3cc4b117036c/')], datetime.timedelta(seconds=130))]
    writeToFile(result_file, results)
    generate_figure()


if __name__ == '__main__':
    main(sys.argv)
